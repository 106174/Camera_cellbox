<Window x:Class="Camera_Organoids.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Camera_Organoids"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        mc:Ignorable="d"
        Title="MainWindow" Height="900" Width="2200">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1000"/>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="1000"/>
        </Grid.ColumnDefinitions>

        <Image Name="CameraView" Stretch="Uniform" Grid.Row="0" Grid.Column="0" />

        <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <StackPanel.Resources>
                <Style TargetType="FrameworkElement">
                    <Setter Property="Margin" Value="0,0,10,0"/>
                </Style>
            </StackPanel.Resources>
            <Button Content="图像重连" Click="refreshCamera" Margin="0"/>
            <TextBlock VerticalAlignment="Center" Margin="0">保存路径:</TextBlock>
            <TextBox Name="SavePathBox" Width="300" IsReadOnly="True" Margin="0"/>
            <Button Content="选择路径" Click="SelectPathButton_Click" Margin="0"/>
            <Button Content="截图" Click="CaptureButton_Click" Margin="0"/>
        </StackPanel>

        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Vertical" HorizontalAlignment="Center" >
            <!-- 串口面板 -->
            <TextBlock  FontSize="20" Margin="0 20 0 0">电机连接串口:</TextBlock>
            <ComboBox x:Name="cmbPorts" Width="120" Height="30" Margin="0 10 0 0"/>
            <Button x:Name="btnRefresh" Content="刷新" FontSize="20" Margin="0 20 0 00" Click="BtnRefresh_Click" Height="35" Width="100"/>
            <Button x:Name="btnConnect" Content="连接" FontSize="20" Margin="0 20 0 0" Click="BtnConnect_Click" Height="35" Width="100"/>
            <Button x:Name="btnDisconnect" Content="断开" FontSize="20" Margin="0 20 0 20" Click="BtnDisconnect_Click" Height="35" Width="100"/>

            <!-- 移动步数核心控件：可编辑的ComboBox -->
            <TextBlock  FontSize="20" Margin="0 20 0 0">电机移动步数:</TextBlock>
            <ComboBox x:Name="editableComboBox" 
                      IsEditable="True"  
                      TextSearch.TextPath="Content"
                      StaysOpenOnEdit="True"
                      Width="100" FontSize="15" Margin="0 10 0 10">

                <!-- 预设选项 -->
                <ComboBoxItem Content="5" />
                <ComboBoxItem Content="20" />
                <ComboBoxItem Content="50" />
            </ComboBox>
            <Button Content="前进" Click="Motor_Forward" FontSize="20" Margin="10" Height="35" Width="100"/>
            <Button Content="后退" Click="Motor_Backwards" FontSize="20" Margin="10" Height="35" Width="100"/>
            <Button Content="停止" Click="Motor_Stop" FontSize="20" Margin="10" Height="35" Width="100"/>
            <!-- 灯光控制 -->
            <Button Content="开灯" Click="LightOn" FontSize="20" Margin="0 30 0 10" Height="35" Width="100"/>
            <Button Content="关灯" Click="LightOff" FontSize="20" Margin="10" Height="35" Width="100"/>
        </StackPanel>
        <!-- 右侧两个图表 -->
        <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Vertical">

            <!-- CO2 图 -->
            <lvc:CartesianChart x:Name="Co2Chart"
                                Height="350"
                                Margin="20"
                                DisableAnimations="True"
                                LegendLocation="Right">
                <lvc:CartesianChart.AxisX>
                    <lvc:Axis Title="时间"
                              LabelFormatter="{Binding TimeFormatter}" />
                </lvc:CartesianChart.AxisX>
                <lvc:CartesianChart.AxisY>
                    <lvc:Axis Title="CO₂ (%)" MinValue="0" MaxValue="10"/>
                </lvc:CartesianChart.AxisY>
            </lvc:CartesianChart>

            <!-- 温度 图 -->
            <lvc:CartesianChart x:Name="TempChart"
                                Height="350"
                                Margin="20"
                                DisableAnimations="True"
                                LegendLocation="Right">
                <lvc:CartesianChart.AxisX>
                    <lvc:Axis Title="时间"
                              LabelFormatter="{Binding TimeFormatter}" />
                </lvc:CartesianChart.AxisX>
                <lvc:CartesianChart.AxisY>
                    <lvc:Axis Title="温度 (°C)" MinValue="10" MaxValue="50" />
                </lvc:CartesianChart.AxisY>
            </lvc:CartesianChart>

        </StackPanel>
    </Grid>
</Window>
